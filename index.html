<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Confess to Your Crush</title>
<style>
body { 
  font-family: Arial, sans-serif; 
  background: linear-gradient(to right, #fbc2eb, #a6c1ee); 
  text-align:center; 
  padding:20px;
  overflow-x:hidden;
  animation: gradientBG 10s ease infinite;
}
@keyframes gradientBG {0% { background-position: 0% 50%; }50% { background-position: 100% 50%; }100% { background-position: 0% 50%; }}
.card { 
  background: rgba(255,255,255,0.95); 
  padding:20px; 
  border-radius:15px; 
  margin:20px auto; 
  max-width:500px; 
  box-shadow:0 0 15px rgba(0,0,0,0.2); 
  opacity:0;
  transform: translateY(20px);
  animation: fadeIn 1s forwards;
}
@keyframes fadeIn{ to { opacity:1; transform:translateY(0); } }
input, textarea, select, button { 
  width: 90%; 
  padding:10px; 
  margin:8px 0; 
  border-radius:8px; 
  border:1px solid #ccc; 
  font-size:16px; 
}
button { 
  background-color:#ff6b81; 
  color:white; 
  font-weight:bold; 
  cursor:pointer; 
  transition: transform 0.2s;
}
button:hover { transform: scale(1.05); }
.confession, .reply { 
  background:#ffe0f0; 
  margin:10px 0; 
  padding:10px; 
  border-radius:8px; 
  text-align:left; 
  animation: fadeIn 0.5s forwards;
}
.emoji { 
  font-size:24px; 
  margin-left:5px; 
  cursor:pointer; 
}
a { color:#ff4fa3; text-decoration:none; }
a:hover { text-decoration:underline; }
#musicBtn { 
  position: fixed; 
  top: 10px; 
  right: 10px; 
  background:#ff6b81; 
  border:none; 
  border-radius:50%; 
  width:50px; 
  height:50px; 
  cursor:pointer; 
  color:white; 
  font-size:24px;
}
</style>
</head>
<body>

<audio id="bgMusic" loop autoplay>
  <source src="https://www.bensound.com/bensound-music/bensound-romantic.mp3" type="audio/mpeg">
</audio>
<button id="musicBtn" onclick="toggleMusic()">ğŸµ</button>

<div class="card" id="welcomeCard">
  <h2>Hi there! ğŸ‘‹</h2>
  <p>
    Are you shy or â€œtorpeâ€? Confess anonymously! ğŸ’–
  </p>
  <button onclick="startConfession()">Continue</button>
</div>

<div class="card" id="confessCard" style="display:none;">
<h2>Write Your Confession ğŸ’–</h2>
<input type="text" id="boyName" placeholder="Your Name">
<textarea id="confessMessage" rows="4" placeholder="Write your confession..."></textarea>
<input type="text" id="youtubeLink" placeholder="YouTube link (optional)">
<select id="confessType">
  <option value="crush">I like you ğŸ’˜</option>
  <option value="court">Can I court you? ğŸŒ¸</option>
</select>
<p>Add Emoji:</p>
<span class="emoji" onclick="addEmoji('â¤ï¸')">â¤ï¸</span>
<span class="emoji" onclick="addEmoji('ğŸ˜ƒ')">ğŸ˜ƒ</span>
<span class="emoji" onclick="addEmoji('ğŸ˜¢')">ğŸ˜¢</span>
<span class="emoji" onclick="addEmoji('ğŸ˜¡')">ğŸ˜¡</span>
<span class="emoji" onclick="addEmoji('ğŸ˜‚')">ğŸ˜‚</span>
<br>
<button onclick="generateLink()">Generate Shareable Link</button>
<p id="linkMsg"></p>
<button id="copyBtn" style="display:none;" onclick="copyLink()">Copy Link</button>
</div>

<div class="card" id="viewCard" style="display:none;">
<h2>Confession ğŸ’Œ</h2>
<p><strong id="confessToName"></strong> (<span id="confessTypeDisplay"></span>)</p>
<p id="confessText"></p>
<div id="youtubeDiv"></div>

<h3>Reply to this confession</h3>
<input type="text" id="replyName" placeholder="Your Name / Nickname">
<textarea id="replyMessage" rows="3" placeholder="Write your reply..."></textarea>
<p>Add Emoji:</p>
<span class="emoji" onclick="addReplyEmoji('â¤ï¸')">â¤ï¸</span>
<span class="emoji" onclick="addReplyEmoji('ğŸ˜ƒ')">ğŸ˜ƒ</span>
<span class="emoji" onclick="addReplyEmoji('ğŸ˜¢')">ğŸ˜¢</span>
<span class="emoji" onclick="addReplyEmoji('ğŸ˜¡')">ğŸ˜¡</span>
<span class="emoji" onclick="addReplyEmoji('ğŸ˜‚')">ğŸ˜‚</span>
<br>
<button onclick="submitReply()">Submit Reply</button>
<p id="replyMsg"></p>

<h3>Replies Received:</h3>
<div id="replyList"></div>
</div>

<script>
let confessionData = {};
let urlParams = new URLSearchParams(window.location.search);

function startConfession(){
  document.getElementById('welcomeCard').style.display='none';
  document.getElementById('confessCard').style.display='block';
}

function addEmoji(emoji){ document.getElementById('confessMessage').value += emoji; }
function addReplyEmoji(emoji){ document.getElementById('replyMessage').value += emoji; }

function generateLink(){
  const name = document.getElementById('boyName').value.trim();
  const message = document.getElementById('confessMessage').value.trim();
  const youtube = document.getElementById('youtubeLink').value.trim();
  const type = document.getElementById('confessType').value;
  if(!name || !message){ alert('Fill name and message'); return; }

  confessionData = {name,message,youtube,type,reply:[]};
  localStorage.setItem('confession', JSON.stringify(confessionData));
  const encoded = encodeURIComponent(JSON.stringify(confessionData));
  const shareLink = window.location.origin + window.location.pathname + '?data=' + encoded;

  document.getElementById('linkMsg').innerHTML = `Copy this link and send to your crush: <br><a href="${shareLink}" target="_blank">${shareLink}</a>`;
  document.getElementById('copyBtn').style.display='inline-block';
  document.getElementById('copyBtn').setAttribute('data-link', shareLink);
}

function copyLink(){
  const link = document.getElementById('copyBtn').getAttribute('data-link');
  navigator.clipboard.writeText(link).then(()=>{ alert('Link copied to clipboard!'); })
  .catch(()=>{ alert('Failed to copy link.'); });
}

function loadConfession(){
  const dataParam = urlParams.get('data');
  if(dataParam){
    confessionData = JSON.parse(decodeURIComponent(dataParam));

    // Merge with any existing replies in localStorage
    let savedConf = localStorage.getItem('confession');
    if(savedConf){
      savedConf = JSON.parse(savedConf);
      if(savedConf.reply && savedConf.reply.length > 0){
        confessionData.reply = savedConf.reply;
      }
    }

    document.getElementById('confessCard').style.display='none';
    document.getElementById('welcomeCard').style.display='none';
    document.getElementById('viewCard').style.display='block';
    
    document.getElementById('confessToName').innerText = confessionData.name;
    document.getElementById('confessTypeDisplay').innerText = confessionData.type==='crush'? 'I like you ğŸ’˜' : 'Can I court you? ğŸŒ¸';
    document.getElementById('confessText').innerText = confessionData.message;
    if(confessionData.youtube) document.getElementById('youtubeDiv').innerHTML = `<a href="${confessionData.youtube}" target="_blank">ğŸµ Listen to music</a>`;
    displayReplies();
  }
}

function submitReply(){
  const rName = document.getElementById('replyName').value.trim();
  const rMsg = document.getElementById('replyMessage').value.trim();
  if(!rName || !rMsg){ alert('Fill your name and reply'); return; }

  confessionData.reply.push({name:rName,message:rMsg});
  localStorage.setItem('confession', JSON.stringify(confessionData));

  document.getElementById('replyName').value=''; 
  document.getElementById('replyMessage').value='';
  document.getElementById('replyMsg').innerText='Reply submitted!';
  displayReplies();
}

function displayReplies(){
  const listDiv = document.getElementById('replyList');
  listDiv.innerHTML='';
  confessionData.reply.forEach(r=>{
    const div = document.createElement('div');
    div.className='reply';
    div.innerHTML=`<strong>${r.name}:</strong> ${r.message}`;
    listDiv.appendChild(div);
  });
}

function toggleMusic(){
  const music = document.getElementById('bgMusic');
  if(music.paused){ music.play(); } else { music.pause(); }
}

loadConfession();
</script>
</body>
</html>
